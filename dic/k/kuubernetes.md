# Kubernetes

Kubernetes(通称「k8s」)とは、コンテナ化したアプリケーションのデプロイ、スケーリングや管理を行うためのオープンソースのプラットフォームである。Dockerと同様にGo言語で開発されており、2023年現在において、Dockerと双璧をなすコンテナ技術として利用されている。

## Kubernetesが開発された経緯

Kubernetesは、コンテナ化されたアプリケーションを大規模にデプロイし管理するという課題に対処するために開発された。Kubernetesが開発される以前は、コンテナを大規模にデプロイし管理することは、複雑で手動のプロセスであり、多くの労力と専門知識が必要だった。

確かに、DockerはWeb開発において便利である。しかし、本番環境において使用するには、Dockerの場合だと基本的に1つのコンテナにつき1つの機能しか実行できないことがある。よって、複雑なアプリケーションを構築する場合には、複数のコンテナを必要とする。では、どのように構築すべきだろうか？

例えば、Docker Composeを用いた場合を考えてみよう。しかしながら、複数のコンテナを1つのサーバーに収めることができないため、どのコンテナがどのサーバーにあるか管理しなければならない。また、コンテナが停止した場合には、すみやかに復旧できるようにしなければならない。さらに、複数のサーバーを跨いだコンテナ間の通信は複雑であるため、注意を払う必要がある。

また、コンテナを更新する場合には、コンテナ間の依存関係やデプロイの順序などを考慮しなければならない。さらに、複数のサーバーにコンテナがある場合には、ロードバランシングも必要となる。また、サーバーのスケーリングも必要となる。各コンテナからはログが出力されるものの、これらを適切に管理しなければ運用が困難となることもある。

このようなタスクは、Kubernetesであれば解決できる。

要は、Kubernetesは、移植性、拡張性、柔軟性に優れており、オンプレミスのデータセンターからパブリッククラウドまで、さまざまな環境で使用できるように設計されている。Kubernetesは、最新のアプリケーション開発とデプロイメントに不可欠なツールとなっており、企業は複雑な分散アプリケーションを容易に構築・管理できるようになった。

## Kubernetesが使われる理由

Kubernetesは現在のWeb開発で使われている理由は、主に以下の様な特徴を持っていることにある。

- スケーラビリティが高い：Kubernetesは、クラウドネイティブなアプリケーションを構築するためのプラットフォームであり、スケーラビリティが非常に高いため、急激なトラフィックの変化にも柔軟に対応できる。KubernetesはWindows、macOSやLinuxどれも対応している。
- アプリケーションのデプロイ自動化と管理が得意：Kubernetesは、アプリケーションの自動化されたデプロイと管理を可能にするための機能を提供しており、DevOpsチームがアプリケーションの展開と管理にかかる時間を大幅に短縮することができる。
- ポータビリティが高い：Kubernetesは、複数のクラウドプロバイダーとオンプレミス環境で動作するため、アプリケーションをどこでも実行できるようになる。これにより、ベンダーロックインのリスクを軽減し、アプリケーションのポータビリティを高めることができる。
- マイクロサービスのサポート：Kubernetesは、マイクロサービスアーキテクチャを採用したアプリケーションの開発と管理を簡単にするための機能を提供している。これにより、アプリケーションを小さなサービスに分割し、それぞれのサービスを個別に展開および管理することができる。
- 障害に強い：Kubernetesは、高可用性のための冗長性を提供するために、複数のノードにアプリケーションをデプロイできる。また、障害が発生した場合には、自動的に障害のあるノードからアプリケーションを再スケジュールすることができる。

これらの特徴により、Kubernetesは現在のDevOpsを実現する上で非常に強力なプラットフォームだといえよう。

## Kubernetesの強み

- 多種多様なワークフローに対応できるほど機能が豊富
- 宣言的設定と突き合わせループでリソースを管理できる
- 幅広いデプロイ形式のサポート
- 拡張性が高い

## 用語

- Cluster
  - Kubernetesのリソースを管理する集合体。Master Nodeと複数のNodeから構成される。
- Node
  - Kubernetesのリソースの中で最も大きな概念。
- Pod
  - コンテナの集合体。Nodeの中で動作し、１つ以上のコンテナを持っている。原則、Kubernetesでコンテナを運用・管理する際にはPod単位で行う。Kubernetesにデプロイする際には、Pod単位で実施する。
- Deployment
  - Podを管理する方法を定義する。
- DaemonSet
  - クラスタが動作するサーバ１つにつき、必ず１つは起動させたいPodを定義する。
- Job
  - 処理を行って終了するようなPodを定義する。
- CronJob
  - JobリソースをCronのように定期的に変更する
- Service
  - 外部やクラスタ内からのリクエストをPodに割り振るようなネットワーク定義。
- ConfigMap
  - 環境変数等、Podで利用する設定を定義する。
- Secret
  - パスワードやトークン情報等、Podで利用する設定を定義する。
- Volume
  - Podで利用するストレージを定義する。
